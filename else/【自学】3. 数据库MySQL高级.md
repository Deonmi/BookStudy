# 数据库MySQL学习笔记高级篇

[TOC]

## 写在前面

学习链接：[数据库 MySQL 视频教程全集](https://www.bilibili.com/video/av59623481)

## 1. mysql的架构介绍

### mysql简介

#### 概述

![img](https://img-blog.csdnimg.cn/20190807204019905.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxNTc5MDQ1,size_16,color_FFFFFF,t_70)

#### 高级Mysql

- 完整的mysql优化需要很深的功底，大公司甚至有专门的DBA写上述
  - mysql内核
  - sql优化工程师
  - mysql服务器的优化
  - 各种参数常量设定
  - 查询语句优化
  - 主从复制
  - 软硬件升级
  - 容灾备份
  - sql编程

### mysqlLinux版的安装

#### mysql5.5

- 下载地址：https://dev.mysql.com/downloads/mysql/5.5.html#downloads

- 检查当前系统是否安装过mysql：

  - 查询命令：rpm -qa|grep -i mysql
  - 删除命令：rpm -e RPM软件包名称
    - 删除自带的mysql：yum -y remove mysql-libs-5.1.73-7.el6.x86_64
  - 没装过，则没有安装过

- 安装mysql服务端（注意提示）：

  - rpm -ivh MySQL-server-5.5.48-1.linux2.6.i386.rpm
  - 如果报错libc.so.6：https://blog.csdn.net/xiyuliuyang/article/details/90750049
  - 如果警告key ID 5072e1f5: NOKEY：https://blog.csdn.net/Aaron960214/article/details/78451321

- 安装mysql客户端

  - rpm -ivh MySQL-client-5.5.48-1.linux2.6.i386.rpm

- 查看MySQL安装时创建的mysql用户和mysql组

  - cat /etc/passwd|grep mysql
  - cat /etc/group|grep mysql
  - mysqladmin --version

- mysql服务的启+停

  - service mysql start

  - service mysql start

    - 如果报错ERROR! The server quit without updating PID file (/var/lib/mysql/localhost.localdomain.pid).

    - 解决办法：https://www.cnblogs.com/bingco/p/8068243.html

      ```
      mysql_install_db --datadir=/var/lib/mysql
      chown mysql:mysql /var/lib/mysql -R
      ```

  - 查看mysql的进程：ps -ef|grep mysql

- mysql服务启动后，开始连接

  - 首次连接成功：mysql（不需要输入密码）
  - 给root用户设置密码：/usr/bin/mysqladmin -u root password 123456

- 自启动mysql服务

  - 设置开机自启动mysql：chkconfig mysql on
  - 查看mysql的等级：chkconfig --list | grep mysql
  - 查看不同等级代表的含义：cat /etc/inittab
  - 查看开机自动服务有哪些：ntsysv

- 修改配置文件位置

- 修改字符集和数据存储路径

- **MySQL的安装位置**

  - /var/lib/mysql：mysql数据库文件的存放路径
  - /usr/share/mysql：配置文件目录
  - /usr/bin：相关命令目录
  - /etc/init.d/mysql：启停相关脚本

### mysql逻辑架构介绍

### mysql存储引擎

## 2. 索引优化分析

### 性能下降SQL慢

#### 执行时间长

#### 等待时间长

### 常见通用的Join查询

### 索引简介

### 性能分析

### 索引优化

## 3. 查询截取分析

### 查询优化

### 慢查询日志

### 批量数据脚本

### Show Profile

### 全局查询日志

## 4. MySQL锁机制

### 概述

### 三锁

#### 表锁（偏读）

#### 行锁（偏写）

#### 页锁

## 5. 主从复制

### 复制的基本原则

### 复制的最大问题

### 一主一从常见配置